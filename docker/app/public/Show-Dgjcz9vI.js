import{u as p,a as x,w as _,j as s,a$ as T,b0 as C,L as H,bO as O,f as V,a7 as z,aT as G,Y as Q,bp as Y,M as K,i as r,b as U,dt as J,dr as W,d as X,ds as Z,ez as ss,du as es,a1 as ts,Q as y,S as as,aY as ns,l as os,bm as u,T as is,k as ls,a2 as cs,eA as rs,a5 as ds,a6 as ms,bA as us,h as ps,eB as xs,r as hs,e as js}from"./bundle.D3-hVUGj.js";import{I as d}from"./InfoCard-DhU0axAB.js";import{a as fs}from"./hooks-Dps_clU3.js";import{D as bs}from"./DataTableColumnsPicker-nvfGKatE.js";import{u as vs}from"./useShowEditOption-CWKf-fnf.js";import{C as ks}from"./ClientActionButtons-YTWpr-RA.js";import{P as Ns}from"./PreviousNextNavigation-BpWEW6Fs.js";import"./atoms-CQqBLmIS.js";function gs(i){const[t]=p(),{project:n}=i,l=x(),o=_();return s.jsx(s.Fragment,{children:!!(n&&n.private_notes)&&s.jsx(d,{title:t("private_notes"),className:"shadow-sm h-full 2xl:h-max col-span-12 lg:col-span-6 xl:col-span-4 2xl:col-span-3 p-4",style:{borderColor:l.$24},withoutPadding:!0,children:s.jsx("div",{className:"whitespace-normal pt-1 min-h-32 max-h-56 overflow-y-auto",children:s.jsx("article",{className:C("prose prose-sm",{"prose-invert":o==null?void 0:o.dark_mode}),dangerouslySetInnerHTML:{__html:T(n.private_notes)}})})})})}function ys(i){const[t]=p(),{project:n}=i,l=x(),o=_();return s.jsx(s.Fragment,{children:!!(n&&n.public_notes)&&s.jsx(d,{title:t("public_notes"),className:"shadow-sm h-full 2xl:h-max col-span-12 lg:col-span-6 xl:col-span-4 2xl:col-span-3 p-4",style:{borderColor:l.$24},withoutPadding:!0,children:s.jsx("div",{className:"whitespace-normal pt-1 min-h-32 max-h-56 overflow-y-auto",children:s.jsx("article",{className:C("prose prose-sm",{"prose-invert":o==null?void 0:o.dark_mode}),dangerouslySetInnerHTML:{__html:T(n.public_notes)}})})})})}ps.extend(xs);function Es(){var f,b,v,k,N,g;const{documentTitle:i}=H("project"),{t}=p(),{id:n}=O(),{dateFormat:l}=V(),o=z(),w=G(),h=Q(),A=Y(),P=K(),j=[{name:t("projects"),href:"/projects"},{name:t("project"),href:r("/projects/:id",{id:n})}],{data:e}=U({queryKey:["/api/v1/projects",`/api/v1/projects/${n}`],queryFn:()=>hs("GET",js(`/api/v1/projects/${n}?include=client,tasks,invoices,quotes,expenses`)).then(a=>a.data.data),staleTime:1/0}),$=fs(),F=J(),E=W(),B=X(),M=Z(),S=ss(),R=es(),L=vs(),m=x(),{changeTemplateVisible:q,setChangeTemplateVisible:D,changeTemplateResources:I}=ts();return e?s.jsxs(y,{title:i,breadcrumbs:j,...(h("edit_project")||A(e))&&e&&{navigationTopRight:s.jsx(us,{resource:e,actions:$,saveButtonLabel:t("edit"),onSaveClick:()=>o(r("/projects/:id/edit",{id:n})),cypressRef:"projectActionDropdown"})},afterBreadcrumbs:s.jsx(Ns,{entity:"project"}),children:[s.jsxs("div",{className:"grid grid-cols-12 lg:space-y-0 gap-4",children:[s.jsx(d,{title:e.name,className:"shadow-sm h-full 2xl:h-max col-span-12 lg:col-span-6 xl:col-span-4 2xl:col-span-3 p-4",style:{borderColor:m.$24},withoutPadding:!0,children:s.jsxs("div",{className:"flex flex-col space-y-3 pt-1",children:[e&&s.jsxs("div",{className:"flex space-x-10",children:[s.jsx("span",{className:"text-sm font-medium",style:{color:m.$3},children:t("status")}),s.jsx(ns,{entity:e})]}),e.client&&s.jsx(ks,{displayClientName:!0,client:e.client}),s.jsxs("div",{children:[e.due_date.length>0&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-sm font-medium",children:[t("due_date"),":"]}),s.jsx("span",{className:"text-sm",children:os(e.due_date,l)})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-sm font-medium",children:[t("budgeted_hours"),":"]}),s.jsx("span",{className:"text-sm",children:w(e.budgeted_hours)})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-sm font-medium",children:[t("task_rate"),":"]}),s.jsx("span",{className:"text-sm",children:B(e.task_rate,(f=e.client)==null?void 0:f.country_id,(b=e.client)==null?void 0:b.settings.currency_id)})]})]}),s.jsxs("div",{children:[(v=e==null?void 0:e.invoices)==null?void 0:v.map((a,c)=>s.jsxs(u,{to:r("/invoices/:id/edit",{id:a.id}),children:[t("invoice")," #",a.number]},c)),(k=e==null?void 0:e.quotes)==null?void 0:k.map((a,c)=>s.jsxs(u,{to:r("/quotes/:id/edit",{id:a.id}),children:[t("quote")," #",a.number]},c)),(N=e==null?void 0:e.expenses)==null?void 0:N.map((a,c)=>s.jsxs(u,{to:r("/expenses/:id/edit",{id:a.id}),children:[t("expense")," #",a.number]},c))]})]})}),s.jsx(gs,{project:e}),s.jsx(ys,{project:e}),s.jsxs(d,{title:t("summary"),className:"shadow-sm h-full 2xl:h-max col-span-12 lg:col-span-6 xl:col-span-4 2xl:col-span-3 p-4",style:{borderColor:m.$24},withoutPadding:!0,children:[s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("span",{className:"font-medium",children:[t("active_tasks"),":"]}),s.jsx("span",{children:(g=e.tasks)==null?void 0:g.length})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("span",{className:"font-medium",children:[t("total_hours"),":"]}),s.jsx("span",{children:Math.floor(e.current_hours)})]})]})]}),P(is.Tasks)&&s.jsx("div",{className:"my-4",children:s.jsx(ls,{resource:"task",columns:E,customActions:F,endpoint:`/api/v1/tasks?include=status,client,project&sort=id|desc&project_tasks=${e.id}&without_deleted_clients=true`,bulkRoute:"/api/v1/tasks/bulk",linkToCreate:`/tasks/create?project=${n}&rate=${e.task_rate}`,linkToEdit:"/tasks/:id/edit",showEdit:a=>L(a),customFilters:M,customBulkActions:R,customFilterPlaceholder:"status",withResourcefulActions:!0,rightSide:s.jsx(bs,{columns:S,defaultColumns:rs,table:"task"}),linkToCreateGuards:[cs("create_task")],hideEditableOptions:!h("edit_task")})}),s.jsx(ds,{entity:"project",entities:I,visible:q,setVisible:D,labelFn:a=>s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx(ms,{children:t("number")}),s.jsx("span",{children:a.number})]}),bulkUrl:"/api/v1/projects/bulk"})]}):s.jsx(y,{title:i,breadcrumbs:j,children:s.jsx(as,{})})}export{Es as default};
