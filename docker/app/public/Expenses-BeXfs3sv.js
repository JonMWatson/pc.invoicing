import{u as h,p as m,j as e,aw as b,bd as g,ax as f,aF as k,fm as C,fn as y,e7 as _,bj as v,fo as A,ao as D,aa as w,c1 as B,e as E,D as I,ab as T,L as F,Y as P,dv as S,dx as M,dw as O,fp as V,Q as L,k as N,a2 as x,fq as z,a3 as G,a4 as $}from"./bundle.D3-hVUGj.js";import{D as q}from"./DataTableColumnsPicker-nvfGKatE.js";import{I as H}from"./ImportButton-DQq538as.js";import"./Import-4Hd9h9R0.js";function Q({isVisible:a,setIsVisible:r,selectedExpenses:c,setSelected:l}){const[o]=h(),[u,i]=m.useState(""),d=A(),{isAdmin:j,isOwner:s}=D();m.useEffect(()=>()=>{i("")},[]);const n=()=>{g.processing();const t=c.map(({id:p})=>p);d(t,"bulk_categorize",{category_id:u}),l&&l([]),r(!1),i("")};return e.jsxs(w,{title:`${o("change")} ${o("category")}`,visible:a,onClose:r,overflowVisible:!0,children:[e.jsxs("p",{children:[o("recurring_expenses"),":"]}),e.jsx("ul",{children:c.map(({id:t,number:p})=>e.jsx("li",{children:p},t))}),e.jsx(B,{endpoint:E("/api/v1/expense_categories"),inputOptions:{value:u,label:o("category")??""},entryOptions:{id:"id",label:"name",value:"id"},sortBy:"name|asc",onChange:t=>t.resource?i(t.resource.id):null}),e.jsxs("p",{children:[e.jsx("span",{className:"capitalize",children:o("manage")})," ",e.jsx(I,{className:"lowercase",to:"/settings/expense_settings",renderSpan:!j&&!s,children:o("expense_categories")})]}),e.jsx(T,{onClick:n,children:o("save")})]})}const U=()=>{const[a]=h(),r=v(),c=s=>s.some(({documents:n})=>n.length),l=s=>s.flatMap(({documents:n})=>n.map(({id:t})=>t)),o=s=>s.every(({should_be_invoiced:n,invoice_id:t})=>n&&!t.length),u=(s,n)=>{const t=l(s);r(t,"download"),n([])},[i,d]=m.useState(!1);return[({selectedResources:s,setSelected:n})=>e.jsx(b,{onClick:()=>c(s)?u(s,n):g.error("no_documents_to_download"),icon:e.jsx(f,{element:k}),children:a("documents")}),({selectedResources:s})=>o(s)&&e.jsx(C,{expenses:s,bulkAction:!0}),({selectedResources:s,setSelected:n})=>e.jsxs(e.Fragment,{children:[s?e.jsx(Q,{isVisible:i,setIsVisible:d,selectedExpenses:s,setSelected:n}):null,e.jsxs(b,{onClick:()=>s.length?d(!0):g.error("no_expenses_selected"),icon:e.jsx(f,{element:y}),children:[a("change")," ",a("category")]})]}),({selectedIds:s,setSelected:n})=>e.jsx(_,{entity:"expense",resourceIds:s,setSelected:n})]};function X(){F("expenses");const[a]=h(),r=P(),c=[{name:a("expenses"),href:"/expenses"}],l=S(),o=M(),u=O(),i=V(),d=U();return e.jsx(L,{title:a("expenses"),breadcrumbs:c,docsLink:"en/expenses",children:e.jsx(N,{resource:"expense",endpoint:"/api/v1/expenses?include=client,vendor,category,project&without_deleted_clients=true&without_deleted_vendors=true&sort=id|desc",columns:l,bulkRoute:"/api/v1/expenses/bulk",linkToCreate:"/expenses/create",linkToEdit:"/expenses/:id/edit",customActions:o,customFilters:u,customBulkActions:d,customFilterPlaceholder:"status",withResourcefulActions:!0,rightSide:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{columns:i,defaultColumns:z,table:"expense"}),e.jsx(G,{type:"component",guards:[$(x("create_expense"),x("edit_expense"))],component:e.jsx(H,{route:"/expenses/import"})})]}),linkToCreateGuards:[x("create_expense")],hideEditableOptions:!r("edit_expense"),enableSavingFilterPreference:!0})})}export{X as default};
