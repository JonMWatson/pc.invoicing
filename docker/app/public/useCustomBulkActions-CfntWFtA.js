import{u as C,p as P,a as v,j as s,aw as r,ax as d,a9 as S,aa as B,ab as I,a7 as E,ac as T,bi as O,Y as N,at as $,a1 as F,aD as q,aF as h,aI as z,dn as H,bd as x,aO as Q,z as R,bj as V}from"./bundle.D3-hVUGj.js";import{u as Y}from"./useDownloadPdfs-C_Q3GnYI.js";import{b as j}from"./hooks-DdpVpzmL.js";import{C as k}from"./CreditStatus-DFPZx7rF.js";import{u as G}from"./payments-w44xId2A.js";import{p as J}from"./atoms-6F-ixHOP.js";const K=n=>{const[o]=C(),[m,l]=P.useState(!1),{selectedIds:i,setSelected:c}=n,p=j(),u=v();return s.jsxs(s.Fragment,{children:[s.jsx(r,{onClick:()=>l(!0),icon:s.jsx(d,{element:S}),children:o("send_email")}),s.jsxs(B,{title:o("bulk_email_credits"),visible:m,onClose:()=>l(!1),children:[s.jsx("span",{className:"text-lg",style:{backgroundColor:u.$2,color:u.$3,colorScheme:u.$0},children:o("are_you_sure")}),s.jsx("div",{className:"flex justify-end space-x-4 mt-5",children:s.jsx(I,{behavior:"button",onClick:()=>{p(i,"email"),c([]),l(!1)},children:o("yes")})})]})]})};/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */const L=()=>{const n=E(),o=T(J),{data:m}=G();return l=>{m&&(o({...m.data.data,invoices:[],credits:[],client_id:l[0].client_id}),l.forEach(i=>{o(c=>c&&{...c,credits:[...c.credits,{_id:O(),credit_id:i.id,amount:i.balance>0?i.balance:i.amount}]})}),n("/payments/create?action=apply&type=1"))}},ne=()=>{const[n]=C(),o=j(),m=N(),l=V(),i=L(),c=$({entity:"credit"}),p=Y({entity:"credit"}),u=e=>!e.some(({status_id:t,is_deleted:a})=>t!==k.Draft||a),y=e=>e.some(({documents:t})=>t.length),f=e=>e.flatMap(({documents:t})=>t.map(({id:a})=>a)),_=(e,t)=>{const a=f(e);l(a,"download"),t([])},b=e=>{if(e.length){if(R(e).pluck("client_id").unique().toArray().length>1)return x.error("multiple_client_error");i(e)}},g=e=>e.every(({client_id:t,amount:a,status_id:M})=>t&&a>0&&M!==k.Applied),{setChangeTemplateVisible:w,setChangeTemplateResources:A,setChangeTemplateEntityContext:D}=F();return[({selectedIds:e,setSelected:t})=>s.jsx(K,{selectedIds:e,setSelected:t}),({selectedIds:e,setSelected:t})=>s.jsx(r,{onClick:()=>{c(e),t([])},icon:s.jsx(d,{element:q}),children:n("print_pdf")}),({selectedIds:e,setSelected:t})=>s.jsx(r,{onClick:()=>{p(e),t([])},icon:s.jsx(d,{element:h}),children:n("download_pdf")}),({selectedIds:e,selectedResources:t,setSelected:a})=>u(t)&&s.jsx(r,{onClick:()=>{o(e,"mark_sent"),a([])},icon:s.jsx(d,{element:z}),children:n("mark_sent")}),({selectedResources:e,setSelected:t})=>g(e)&&m("create_payment")&&s.jsx(r,{onClick:()=>{b(e),t([])},icon:s.jsx(d,{element:H}),children:n("apply_credit")}),({selectedResources:e,setSelected:t})=>s.jsx(r,{onClick:()=>y(e)?_(e,t):x.error("no_documents_to_download"),icon:s.jsx(d,{element:h}),children:n("documents")}),({selectedResources:e})=>s.jsx(r,{onClick:()=>{w(!0),A(e),D({endpoint:"/api/v1/credits/bulk",entity:"credit"})},icon:s.jsx(d,{element:Q}),children:n("run_template")})]};export{ne as u};
