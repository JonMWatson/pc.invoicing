import{b as D,r as _,e as $,u as E,t as O,p as u,bc as w,j as e,aa as P,ct as y,dR as A,by as z,ab as R,bd as x,$ as M,bO as Q,a as U,aU as q,cm as G,ac as H,d1 as W,C as T,c7 as J,b0 as V,dS as K,dT as X,d2 as Y,H as I}from"./bundle.D3-hVUGj.js";/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function Z(){return D("/api/v1/locations/create",()=>_("GET",$("/api/v1/locations/create")).then(o=>o.data.data),{staleTime:1/0})}function L({isModalOpen:o,setIsModalOpen:k,blankLocation:t,clientId:N,currentEditingLocation:h,setCurrentEditingLocation:n}){const[r]=E(),b=O(),[p,c]=u.useState(!1),[l,f]=u.useState(),[s,g]=u.useState(t),C=()=>{k(!1),h&&n(null)},S=()=>{p||(x.processing(),f(void 0),c(!0),_("POST",$("/api/v1/locations"),{...s,client_id:N}).then(()=>{x.success("created_location"),M(["clients"]),C()}).catch(a=>{var m;((m=a.response)==null?void 0:m.status)===422&&(f(a.response.data),x.dismiss())}).finally(()=>c(!1)))},B=()=>{p||(x.processing(),f(void 0),c(!0),_("PUT",$("/api/v1/locations/:id",{id:h==null?void 0:h.id}),s).then(()=>{x.success("updated_location"),M(["clients"]),n(null)}).catch(a=>{var m;((m=a.response)==null?void 0:m.status)===422&&(f(a.response.data),x.dismiss())}).finally(()=>c(!1)))},i=(a,m)=>{if(!s)return;const d=w.cloneDeep(s);w.set(d,m,a),g(d)};return u.useEffect(()=>{var a;g(h||w.cloneDeep({...t,country_id:((a=b==null?void 0:b.settings)==null?void 0:a.country_id)||""}))},[o]),e.jsx(P,{title:r(h?"edit_location":"add_location"),visible:o,onClose:C,overflowVisible:!0,children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx(y,{label:r("name"),value:(s==null?void 0:s.name)||"",onValueChange:a=>i(a,"name"),errorMessage:l==null?void 0:l.errors.name}),e.jsx(y,{label:r("address1"),value:(s==null?void 0:s.address1)||"",onValueChange:a=>i(a,"address1"),errorMessage:l==null?void 0:l.errors.address1}),e.jsx(y,{label:r("address2"),value:(s==null?void 0:s.address2)||"",onValueChange:a=>i(a,"address2"),errorMessage:l==null?void 0:l.errors.address2}),e.jsx(y,{label:r("city"),value:(s==null?void 0:s.city)||"",onValueChange:a=>i(a,"city"),errorMessage:l==null?void 0:l.errors.city}),e.jsx(y,{label:r("state"),value:(s==null?void 0:s.state)||"",onValueChange:a=>i(a,"state"),errorMessage:l==null?void 0:l.errors.state}),e.jsx(y,{label:r("postal_code"),value:(s==null?void 0:s.postal_code)||"",onValueChange:a=>i(a,"postal_code"),errorMessage:l==null?void 0:l.errors.postal_code}),e.jsx(A,{label:r("country"),value:(s==null?void 0:s.country_id)||"",onChange:a=>i(a,"country_id"),errorMessage:l==null?void 0:l.errors.country_id}),e.jsx("div",{className:"pt-1",children:e.jsx(z,{label:r("shipping_address"),checked:!!(s!=null&&s.is_shipping_location),onValueChange:a=>i(a,"is_shipping_location")})}),e.jsx("div",{className:"w-full pt-4",children:e.jsx(R,{className:"w-full",type:"primary",behavior:"button",onClick:h?B:S,disabled:p,disableWithoutIcon:!0,children:r("save")})})]})})}const F=I.div`
  background-color: ${o=>o.theme.backgroundColor};

  &:hover {
    background-color: ${o=>o.theme.hoverBackgroundColor};
  }
`,ee=I.div`
  border-color: ${o=>o.theme.borderColor};
`,se=I.div`
  background-color: ${o=>o.theme.backgroundColor};

  &:hover {
    background-color: ${o=>o.theme.hoverBackgroundColor};
  }
`;function oe(){const[o]=E(),{id:k}=Q(),t=U(),N=q(),h=G(),{client:n,setErrors:r}=h,{data:b}=Z(),p=H(W),[c,l]=u.useState(!1),[f,s]=u.useState(!1),[g,C]=u.useState(""),[S,B]=u.useState([]),[i,a]=u.useState(null),m=d=>{!c&&d&&(x.processing(),r(void 0),l(!0),_("DELETE",$("/api/v1/locations/:id",{id:d})).then(()=>{x.success("deleted_location"),M(["clients"])}).catch(v=>{var j;((j=v.response)==null?void 0:j.status)===422&&(r(v.response.data),x.dismiss())}).finally(()=>{l(!1),C(""),p(!1)}))};return u.useEffect(()=>{B((n==null?void 0:n.locations)||[])},[n==null?void 0:n.locations]),u.useEffect(()=>{s(!!i)},[i]),k?e.jsxs(e.Fragment,{children:[e.jsx(T,{title:o("locations"),className:"shadow-sm",style:{borderColor:t.$24},headerStyle:{borderColor:t.$20},children:e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs(se,{className:"flex flex-col space-y-2 items-center justify-center border-dashed border p-6 rounded-md cursor-pointer h-48",theme:{backgroundColor:t.$1,hoverBackgroundColor:t.$20,borderColor:t.$24},onClick:()=>s(!0),children:[e.jsx(J,{size:"2rem",color:t.$3}),e.jsx("span",{children:o("add_location")})]}),S.map((d,v)=>{var j;return e.jsxs(ee,{theme:{borderColor:t.$24},className:"px-3 py-4 flex justify-between space-x-4 border rounded-md h-48",children:[e.jsxs("div",{className:"flex flex-col flex-1 truncate justify-between",children:[e.jsx("span",{className:"text-lg font-semibold truncate mb-2 mt-1",children:d.name}),e.jsxs("div",{className:"flex flex-col space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{style:{color:t.$16},children:[o("address"),":"," "]}),d.address1,d.address1&&d.address2&&`, ${d.address2}`]}),e.jsxs("div",{children:[e.jsxs("span",{style:{color:t.$16},children:[o("city"),": "]}),d.city||"",d.state&&`${d.city?", ":""}${d.state}`,d.postal_code&&`${d.state?" ":""}${d.postal_code}`]}),e.jsxs("div",{children:[e.jsxs("span",{style:{color:t.$16},children:[o("country"),":"," "]}),(j=N(d.country_id))==null?void 0:j.name]}),e.jsxs("div",{children:[e.jsxs("span",{style:{color:t.$16},children:[o("shipping"),":"," "]}),d.is_shipping_location?o("yes"):o("no")]})]})]}),e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsx(F,{className:V("flex items-center justify-center w-8 h-8 rounded-lg border",{"cursor-not-allowed opacity-75":c,"cursor-pointer":!c}),style:{borderColor:t.$24},theme:{hoverBackgroundColor:t.$20,backgroundColor:t.$1},onClick:()=>!c&&a(d),children:e.jsx(K,{size:"1rem",color:"#2176FF"})}),e.jsx(F,{className:V("flex items-center justify-center w-8 h-8 rounded-lg border",{"cursor-not-allowed opacity-75":c,"cursor-pointer":!c}),style:{borderColor:t.$24},theme:{hoverBackgroundColor:t.$20,backgroundColor:t.$1},onClick:()=>{C(d.id),setTimeout(()=>{p(!0)},100)},children:e.jsx(X,{size:"1rem",color:"red"})})]})]},v)})]})})}),e.jsx(Y,{onClick:()=>m(g),disabledButton:c,title:o("delete_location"),message:o("delete_location_confirmation")}),e.jsx(L,{isModalOpen:f,setIsModalOpen:s,blankLocation:b,clientId:n==null?void 0:n.id,currentEditingLocation:i,setCurrentEditingLocation:a})]}):e.jsx(T,{title:o("locations"),className:"shadow-sm",style:{borderColor:t.$24},headerStyle:{borderColor:t.$20},children:e.jsxs("div",{className:"px-6 text-sm",children:[o("save_to_add_locations"),"."]})})}export{oe as default};
