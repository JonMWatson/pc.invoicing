import{bq as E,bI as H,bJ as Q,bd as g,r as A,e as j,$ as P,u as T,j as e,aB as l,aC as u,aw as b,ax as y,aP as $,aQ as B,aR as q,a as N,H as z,bO as R,fY as I,i as d,bo as F,L as O,cK as V,p as m,gh as D,bA as G,bR as J,c2 as K,bS as U}from"./bundle.D3-hVUGj.js";import{d as Y}from"./designs-Cr-Aj-yC.js";import{I as W}from"./InvoiceViewer-CknzAqf8.js";import{a as X,P as Z,b as ee}from"./react-resizable-panels.browser.esm-Byv1N0vt.js";import{r as S}from"./react-responsive-0Pkg7MS9.js";/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function se(){const s=E(),n=H(Q);return async(i,t)=>(g.processing(),A("POST",j("/api/v1/designs/bulk"),{action:t,ids:i}).then(()=>{g.success(`${t}d_design`),P(["designs"]),n&&s.invalidateQueries([n])}))}function ne(){const[s]=T(),n=se();return[t=>l(t)===u.Active&&e.jsx(b,{onClick:()=>n([t.id],"archive"),icon:e.jsx(y,{element:$}),children:s("archive")}),t=>(l(t)===u.Archived||l(t)===u.Deleted)&&e.jsx(b,{onClick:()=>n([t.id],"restore"),icon:e.jsx(y,{element:B}),children:s("restore")}),t=>(l(t)===u.Active||l(t)===u.Archived)&&e.jsx(b,{onClick:()=>n([t.id],"delete"),icon:e.jsx(y,{element:q}),children:s("delete")})]}function te(s){const n=S.useMediaQuery({query:"(min-width: 1024px)"}),{children:i}=s;return n?e.jsx(X,{direction:"horizontal",className:"gap-4 mt-4",children:i}):e.jsx("div",{className:"flex flex-col gap-4",children:i})}function C(s){const n=S.useMediaQuery({query:"(min-width: 1024px)"}),{children:i,renderBasePanel:t}=s;return n||t?e.jsx(Z,{defaultSize:50,minSize:25,children:i}):e.jsx(e.Fragment,{children:i})}const ie=z(ee)`
  background-color: ${s=>s.theme.backgroundColor};
  &:hover {
    background-color: ${s=>s.theme.hoverColor};
  }
`;function ae(){const s=S.useMediaQuery({query:"(min-width: 1024px)"}),n=N();return s?e.jsx(ie,{className:"flex items-center",theme:{hoverColor:"#3366CC",backgroundColor:n.$5},style:{width:"2.5px"}}):e.jsx(e.Fragment,{})}/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function oe(){const[s]=T(),{id:n}=R(),{isCompanySettingsActive:i}=I();return[{name:s("settings"),href:d("/settings/invoice_design/custom_designs/:id/edit",{id:n}),enabled:i},{name:s("body"),href:d("/settings/invoice_design/custom_designs/:id/edit/body",{id:n}),enabled:i},{name:s("header"),href:d("/settings/invoice_design/custom_designs/:id/edit/header",{id:n}),enabled:i},{name:s("footer"),href:d("/settings/invoice_design/custom_designs/:id/edit/footer",{id:n}),enabled:i},{name:s("includes"),href:d("/settings/invoice_design/custom_designs/:id/edit/includes",{id:n}),enabled:i},{name:s("variables"),href:d("/settings/invoice_design/custom_designs/:id/edit/variables",{id:n}),enabled:i}]}const me=F({design:null,entity_id:"-1",entity:"invoice"});function ge(){O("invoice_design");const s=ne(),n=oe(),i=V(),{id:t}=R(),{data:x}=Y({id:t,enabled:!0}),[a,f]=m.useState({design:null,entity_id:"-1",entity:"invoice"}),[r,v]=m.useState(),[h,_]=m.useState(!1),[p,k]=m.useState(!1),w=()=>{h||(g.processing(),_(!0),A("PUT",j("/api/v1/designs/:id",{id:t}),a.design).then(()=>{P(["designs"]),g.success("updated_design")}).catch(o=>{var c;((c=o.response)==null?void 0:c.status)===422&&(v(o.response.data),g.dismiss())}).finally(()=>_(!1)))};return D({element:(a==null?void 0:a.design)&&e.jsx(G,{resource:a.design,onSaveClick:w,actions:s,disableSaveButton:h})},[a.design,h,i]),m.useEffect(()=>(x&&f(o=>({...o,design:x})),()=>f({design:null,entity_id:"-1",entity:"invoice"})),[x]),e.jsxs(e.Fragment,{children:[e.jsx(J,{tabs:n}),e.jsxs(te,{children:[e.jsx(C,{children:e.jsxs("div",{className:"space-y-4 h-full max-h-[80vh] overflow-y-auto",children:[r!=null&&r.errors["design.design.body"]?e.jsxs(K,{type:"danger",children:[e.jsx("p",{children:r.message}),e.jsx("small",{children:r.errors["design.design.body"]})]}):null,e.jsx(U,{context:{errors:r,isFormBusy:h,shouldRenderHTML:p,setShouldRenderHTML:k,payload:a,setPayload:f}})]})}),e.jsx(ae,{}),e.jsx(C,{children:e.jsx("div",{className:"max-h-[80vh] overflow-y-scroll",children:a.design?e.jsx(W,{link:j("/api/v1/preview?html=:renderHTML",{renderHTML:p}),resource:a,method:"POST",withToast:!0,renderAsHTML:p,onError:o=>{var c;if(((c=o.response)==null?void 0:c.status)===422&&o.response.data){const L=new TextDecoder("utf-8").decode(o.response.data),M=JSON.parse(L);v(M)}},onRequest:()=>v(void 0)}):null})})]})]})}export{ge as default,me as payloadAtom};
