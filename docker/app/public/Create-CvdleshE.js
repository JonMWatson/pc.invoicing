import{u as j,t as T,a7 as N,bK as S,L as C,p as c,Z as D,dA as Y,bc as A,h as R,j as n,Q as k,bd as x,r as B,e as F,$ as I,i as q}from"./bundle.D3-hVUGj.js";import{D as M,N as P,A as Q,T as w}from"./Taxes-DxDncNGK.js";import{f as H,g as L,h as O}from"./hooks-CvK-xUg4.js";import"./ProjectSelector-DIb_VaTZ.js";import"./ClientActionButtons-YTWpr-RA.js";import"./PaymentTypeSelector-B5RlAkj_.js";import"./useResolveCurrencySeparator-ygcSKMxa.js";function V(){const[_]=j(),e=T(),v=N(),[r]=S(),{documentTitle:h}=C("new_recurring_expense"),b=[{name:_("recurring_expenses"),href:"/recurring_expenses"},{name:_("new_recurring_expense"),href:"/recurring_expenses/create"}],[o,y]=c.useState(e!=null&&e.calculate_expense_tax_by_amount?"by_amount":"by_rate"),[a,g]=D(Y),{data:u}=H({enabled:typeof a>"u"}),[d,l]=c.useState(),[f,m]=c.useState(!1),i=O({setRecurringExpense:g,setErrors:l});c.useEffect(()=>{g(p=>{let s=p;if(r.get("action")!=="clone"&&(s=void 0),typeof u<"u"&&typeof s>"u"&&r.get("action")!=="clone"){const t=A.cloneDeep(u);t.frequency_id=L.FREQUENCY_MONTHLY,r.get("client")&&(t.client_id=r.get("client")),r.get("vendor")&&(t.vendor_id=r.get("vendor")),s={...t,payment_date:e!=null&&e.mark_expenses_paid?R().format("YYYY-MM-DD"):"",should_be_invoiced:e==null?void 0:e.mark_expenses_invoiceable,invoice_documents:e==null?void 0:e.invoice_expense_documents,calculate_tax_by_amount:o==="by_amount",uses_inclusive_taxes:e.expense_inclusive_taxes}}return s})},[u]);const E=p=>{f||(x.processing(),m(!0),l(void 0),B("POST",F("/api/v1/recurring_expenses"),p).then(s=>{x.success("created_recurring_expense"),I(["recurring_expenses"]),v(q("/recurring_expenses/:id/edit",{id:s.data.data.id}))}).catch(s=>{var t;((t=s.response)==null?void 0:t.status)===422&&(l(s.response.data),x.dismiss())}).finally(()=>m(!1)))};return n.jsx(k,{title:h,breadcrumbs:b,onSaveClick:()=>a&&E(a),disableSaveButton:!a||f,children:n.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[n.jsx("div",{className:"col-span-12 xl:col-span-4",children:n.jsx(M,{recurringExpense:a,handleChange:i,taxInputType:o,pageType:"create",errors:d})}),n.jsx("div",{className:"col-span-12 xl:col-span-4",children:n.jsx(P,{recurringExpense:a,handleChange:i,errors:d})}),n.jsxs("div",{className:"col-span-12 xl:col-span-4 space-y-4",children:[n.jsx(Q,{recurringExpense:a,handleChange:i,errors:d}),n.jsx(w,{recurringExpense:a,handleChange:i,taxInputType:o,setTaxInputType:y})]})]})})}export{V as default};
