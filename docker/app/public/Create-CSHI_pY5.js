import{L as q,u as R,a as T,t as $,bK as w,cl as y,a7 as D,Z as I,p as c,cQ as N,bc as Q,j as a,Q as A,dW as O,C as K,bu as o,ct as _,cq as L,cO as U,cu as B,cv as f,bd as h,r as W,e as Z,$ as z,i as G}from"./bundle.D3-hVUGj.js";import{p as H}from"./atoms-CQqBLmIS.js";function Y(){var S,b,V,k;const{documentTitle:m}=q("new_project"),[i]=R(),v=T(),l=$(),[d]=w(),M=y(),E=D(),F=[{name:i("projects"),href:"/projects"},{name:i("new_project"),href:"/projects/create"}],[e,x]=I(H),[s,C]=c.useState(),[j,p]=c.useState(!1),n=(t,u)=>{x(r=>r&&{...r,[t]:u})},{data:g}=N({enabled:typeof e>"u"}),P=t=>{t.preventDefault(),!j&&(h.processing(),C(void 0),p(!0),W("POST",Z("/api/v1/projects"),e).then(u=>{h.success("created_project"),z(["projects"]),E(G("/projects/:id/edit",{id:u.data.data.id}))}).catch(u=>{var r;((r=u.response)==null?void 0:r.status)===422&&(h.dismiss(),C(u.response.data))}).finally(()=>{p(!1)}))};return c.useEffect(()=>{x(t=>{let u=t;if(d.get("action")!=="clone"&&(u=void 0),typeof g<"u"&&typeof u>"u"&&d.get("action")!=="clone"){const r=Q.cloneDeep(g);r.task_rate=(l==null?void 0:l.settings.default_task_rate)||0,d.get("client")&&(r.client_id=d.get("client")),u=r}return u})},[g]),c.useEffect(()=>{e!=null&&e.client_id&&e.client_id.length>1&&M.find(e.client_id).then(t=>{t.settings.default_task_rate&&n("task_rate",t.settings.default_task_rate)})},[e==null?void 0:e.client_id]),a.jsx(A,{title:m,breadcrumbs:F,disableSaveButton:!e||j,onSaveClick:P,children:a.jsx(O,{breadcrumbs:[],children:a.jsxs(K,{title:m,className:"shadow-sm",style:{borderColor:v.$24},headerStyle:{borderColor:v.$20},children:[a.jsx(o,{leftSide:i("project_name"),required:!0,children:a.jsx(_,{value:e==null?void 0:e.name,onValueChange:t=>n("name",t),errorMessage:s==null?void 0:s.errors.name,cypressRef:"name"})}),a.jsx(o,{leftSide:i("client"),required:!0,children:a.jsx(L,{value:e==null?void 0:e.client_id,onChange:t=>n("client_id",t.id),clearButton:!!(e!=null&&e.client_id),onClearButtonClick:()=>n("client_id",""),errorMessage:s==null?void 0:s.errors.client_id})}),a.jsx(o,{leftSide:i("user"),children:a.jsx(U,{value:e==null?void 0:e.assigned_user_id,onChange:t=>n("assigned_user_id",t.id),onClearButtonClick:()=>n("assigned_user_id",""),errorMessage:s==null?void 0:s.errors.assigned_user_id})}),a.jsx(o,{leftSide:i("due_date"),children:a.jsx(_,{type:"date",value:e==null?void 0:e.due_date,onValueChange:t=>n("due_date",t),errorMessage:s==null?void 0:s.errors.due_date})}),a.jsx(o,{leftSide:i("budgeted_hours"),children:a.jsx(B,{value:(e==null?void 0:e.budgeted_hours)||"",onValueChange:t=>n("budgeted_hours",parseFloat(t)),errorMessage:s==null?void 0:s.errors.budgeted_hours})}),a.jsx(o,{leftSide:i("task_rate"),children:a.jsx(B,{value:(e==null?void 0:e.task_rate)||"",onValueChange:t=>n("task_rate",parseFloat(t)),errorMessage:s==null?void 0:s.errors.task_rate})}),a.jsx(o,{leftSide:i("public_notes"),children:a.jsx(_,{element:"textarea",value:e==null?void 0:e.public_notes,onValueChange:t=>n("public_notes",t),errorMessage:s==null?void 0:s.errors.public_notes})}),a.jsx(o,{leftSide:i("private_notes"),children:a.jsx(_,{element:"textarea",value:e==null?void 0:e.private_notes,onValueChange:t=>n("private_notes",t),errorMessage:s==null?void 0:s.errors.private_notes})}),e&&((S=l==null?void 0:l.custom_fields)==null?void 0:S.project1)&&a.jsx(f,{field:"project1",defaultValue:e.custom_value1||"",value:l.custom_fields.project1,onValueChange:t=>n("custom_value1",t.toString())}),e&&((b=l==null?void 0:l.custom_fields)==null?void 0:b.project2)&&a.jsx(f,{field:"project2",defaultValue:e.custom_value2||"",value:l.custom_fields.project2,onValueChange:t=>n("custom_value2",t.toString())}),e&&((V=l==null?void 0:l.custom_fields)==null?void 0:V.project3)&&a.jsx(f,{field:"project3",defaultValue:e.custom_value3||"",value:l.custom_fields.project3,onValueChange:t=>n("custom_value3",t.toString())}),e&&((k=l==null?void 0:l.custom_fields)==null?void 0:k.project4)&&a.jsx(f,{field:"project4",defaultValue:e.custom_value4||"",value:l.custom_fields.project4,onValueChange:t=>n("custom_value4",t.toString())})]})})})}export{Y as default};
