import{u as f,cQ as p,p as g,t as k,cl as M,j as s,aa as P,ct as _,cq as S,cO as y,ab as V,S as B,bd as h,r as E,e as j,$ as I,Y as O,c1 as w,c2 as F}from"./bundle.D3-hVUGj.js";function $(n){const[l]=f(),{data:r}=p(),[a,o]=g.useState(),[e,c]=g.useState(),[u,C]=g.useState(!1),v=k(),x=M(),i=(t,d)=>{c(void 0),o(b=>b&&{...b,[t]:d})};g.useEffect(()=>{r&&o({...r,task_rate:(v==null?void 0:v.settings.default_task_rate)||0})},[r]),g.useEffect(()=>{a!=null&&a.client_id&&a.client_id.length>1&&x.find(a.client_id).then(t=>{t.settings.default_task_rate&&i("task_rate",t.settings.default_task_rate)})},[a==null?void 0:a.client_id]);const m=t=>{t.preventDefault(),u||(h.processing(),c(void 0),C(!0),E("POST",j("/api/v1/projects"),a).then(d=>{h.success("created_project"),I(["projects"]),window.dispatchEvent(new CustomEvent("invalidate.combobox.queries",{detail:{url:j("/api/v1/projects")}})),n.onProjectCreated(d.data.data),o(r),n.setVisible(!1)}).catch(d=>{var b;((b=d.response)==null?void 0:b.status)===422&&(h.dismiss(),c(d.response.data))}).finally(()=>C(!1)))};return s.jsx(P,{title:l("new_project"),size:"regular",visible:n.visible,onClose:()=>{o(r),n.setVisible(!1)},children:a?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-x-5 gap-y-3",children:[s.jsx(_,{label:l("project_name"),value:a.name,onValueChange:t=>i("name",t),errorMessage:e==null?void 0:e.errors.name}),s.jsx(S,{inputLabel:l("client"),value:a.client_id,onChange:t=>i("client_id",t.id),clearButton:!0,onClearButtonClick:()=>i("client_id",""),errorMessage:e==null?void 0:e.errors.client_id}),s.jsx(y,{inputLabel:l("user"),value:a.assigned_user_id,onChange:t=>i("assigned_user_id",t.id),onClearButtonClick:()=>i("assigned_user_id",""),errorMessage:e==null?void 0:e.errors.assigned_user_id}),s.jsx(_,{label:l("due_date"),type:"date",value:a.due_date,onValueChange:t=>i("due_date",t),errorMessage:e==null?void 0:e.errors.due_date}),s.jsx(_,{label:l("budgeted_hours"),value:a.budgeted_hours,onValueChange:t=>i("budgeted_hours",t),errorMessage:e==null?void 0:e.errors.budgeted_hours}),s.jsx(_,{label:l("task_rate"),value:a.task_rate,onValueChange:t=>i("task_rate",t),errorMessage:e==null?void 0:e.errors.task_rate}),s.jsx(_,{label:l("public_notes"),element:"textarea",value:a.public_notes,onValueChange:t=>i("public_notes",t),errorMessage:e==null?void 0:e.errors.public_notes}),s.jsx(_,{label:l("private_notes"),element:"textarea",value:a.private_notes,onValueChange:t=>i("private_notes",t),errorMessage:e==null?void 0:e.errors.private_notes})]}),s.jsx(V,{className:"flex self-end",disableWithoutIcon:!0,disabled:!a||u,onClick:m,children:l("save")})]}):s.jsx(B,{})})}function L(n){var c;const[l]=f(),r=O(),[a,o]=g.useState(!1),e=n.clientId?`&client_id=${n.clientId}`:"";return s.jsxs(s.Fragment,{children:[s.jsx($,{visible:a,setVisible:o,onProjectCreated:u=>n.onChange(u)}),s.jsx(w,{inputOptions:{label:(c=n.inputLabel)==null?void 0:c.toString(),value:n.value??null},endpoint:j(`/api/v1/projects?status=active&filter_deleted_clients=true${e}`),entryOptions:{id:"id",label:"name",value:"id"},onChange:u=>u.resource?n.onChange(u.resource):null,readonly:n.readonly,onDismiss:n.onClearButtonClick,action:{label:l("new_project"),onClick:()=>o(!0),visible:r("create_project")}}),n.errorMessage?s.jsx(F,{className:"mt-2",type:"danger",children:n.errorMessage}):null]})}export{L as P};
