import{u as v,bO as A,ao as k,bp as S,Y as g,i,j as e,bP as q,bL as B,dU as C,dV as O,p as u,bK as V,Q as D,dW as N,bR as F,bS as H,bA as L,bd as l,e as x,r as Q,$ as U}from"./bundle.D3-hVUGj.js";import{P as $}from"./PreviousNextNavigation-BpWEW6Fs.js";function I(o){const[n]=v(),{product:t}=o,{id:r}=A(),{isAdmin:p,isOwner:s}=k(),m=S(),d=g(),c=d("view_product")||d("edit_product")||m(t);return[{name:n("edit"),href:i("/products/:id/edit",{id:r})},{name:n("documents"),href:i("/products/:id/documents",{id:r}),enabled:c,formatName:()=>{var a;return e.jsx(q,{numberOfDocuments:(a=t==null?void 0:t.documents)==null?void 0:a.length})}},{name:n("product_fields"),href:i("/products/:id/product_fields",{id:r}),enabled:p||s}]}function Y(){const[o]=v(),n=B(),{id:t}=A(),r=g(),p=S(),{data:s}=C({id:t}),m=O(),[d,c]=u.useState(),[b,a]=u.useState(),[h,_]=u.useState(!1),j=[{name:o("products"),href:"/products"},{name:o("edit_product"),href:i("/products/:id",{id:t})}],T=I({product:s==null?void 0:s.data.data}),[f,E]=V(),w=async()=>{if(!h){a(void 0),_(!0),l.processing(),await n({excludeToasters:!0});const R=f.has("update_in_stock_quantity")?x("/api/v1/products/:id?update_in_stock_quantity=true",{id:t}):x("/api/v1/products/:id",{id:t});Q("PUT",R,d).then(()=>{l.success("updated_product"),U(["products"]),f.delete("update_in_stock_quantity"),E(f)}).catch(y=>{var P;((P=y.response)==null?void 0:P.status)===422&&(a(y.response.data),l.dismiss())}).finally(()=>_(!1))}};return u.useEffect(()=>{s&&c(s.data.data)},[s]),e.jsx(D,{title:o("edit_product"),breadcrumbs:j,...s&&(r("edit_product")||p(s.data.data))&&{navigationTopRight:e.jsx(L,{onSaveClick:w,resource:s.data.data,actions:m,cypressRef:"productActionDropdown",disableSaveButton:!s||h})},afterBreadcrumbs:e.jsx($,{entity:"product"}),children:e.jsxs(N,{breadcrumbs:[],children:[e.jsx(F,{tabs:T}),e.jsx(H,{context:{errors:b,setErrors:a,product:d,setProduct:c}})]})})}export{Y as default};
