import{u as A,a7 as M,p as w,j as n,a8 as o,a9 as R,i as p,aa as I,ab as O,Y as D,ac as y,ad as q,ae as F,af as Q,ag as V,ah as H,ai as E,aj as C,ak as $,al as z,am as G,an as J,h as g,t as L,ao as X,ap as U,aq as W,ar as Z,as as ee,at as te,au as ie,a1 as ne,av as oe,aw as ae,ax as se,ay as ce,az as P,aA as S,aB as de,aC as le,aD as re,aE as _e,aF as T,aG as ue,aH as me,aI as pe,aJ as ve,aK as ye,aL as xe,aM as he,aN as Ce,aO as ge,aP as ke,aQ as je,aR as fe,aS as be}from"./bundle.D3-hVUGj.js";import{I as _}from"./invoice-status-We6cAxTk.js";function Pe(d){const[t]=A(),r=M(),[s,i]=w.useState(!1),{invoice:a,isDropdown:v=!1}=d,u=l=>l==null?void 0:l.contacts.some(({email:c})=>c);return n.jsxs(n.Fragment,{children:[n.jsx("div",{onClick:()=>!u(a.client)&&i(!0),children:n.jsx(o,{entity:"invoice",actionKey:"email_invoice",isCommonActionSection:!v,tooltipText:t("email_invoice"),...u(a.client)&&{to:p("/invoices/:id/email",{id:a.id})},icon:R,children:t("email_invoice")})}),n.jsx(I,{title:t("contact_email"),visible:s,onClose:()=>i(!1),children:n.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[n.jsxs("span",{className:"text-base font-medium",children:[t("client_email_not_set"),"."]}),n.jsx(O,{className:"self-end",onClick:()=>{r(p("/clients/:id/edit",{id:a.client_id})),i(!1)},children:t("edit_client")})]})})]})}function Ae(d){const[t]=A(),r=M(),{invoice:s,dropdown:i}=d,a=D(),v=y(q),u=y(F),l=y(Q),c=y(V),m=H(),[x,h]=w.useState(!1),k=()=>{v({...s,id:"",number:"",documents:[],date:g().format("YYYY-MM-DD"),due_date:"",partial_due_date:"",total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0,design_id:m.settings.quote_design_id}),r("/quotes/create?action=clone")},j=()=>{u({...s,id:"",number:"",documents:[],date:g().format("YYYY-MM-DD"),due_date:"",partial_due_date:"",total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0,design_id:m.settings.credit_design_id}),r("/credits/create?action=clone")},f=()=>{c({...s,id:"",number:"",documents:[],frequency_id:"5",total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0,due_date:"",partial_due_date:"",design_id:m.settings.invoice_design_id}),r("/recurring_invoices/create?action=clone")},b=()=>{l({...s,id:"",number:"",documents:[],date:g().format("YYYY-MM-DD"),total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"1",vendor_id:"",paid_to_date:0,due_date:"",partial_due_date:"",design_id:m.settings.purchase_order_design_id}),r("/purchase_orders/create?action=clone")};return n.jsxs(n.Fragment,{children:[(a("create_purchase_order")||a("create_quote")||a("create_recurring_invoice")||a("create_credit"))&&n.jsx(o,{entity:"invoice",actionKey:"clone_to_other",isCommonActionSection:!i,tooltipText:t("clone_to_other"),onClick:()=>h(!0),icon:E,children:t("clone_to_other")}),n.jsx(I,{title:t("clone_to"),visible:x,onClose:()=>h(!1),closeButtonCypressRef:"cloneOptionsModalXButton",children:n.jsx("div",{className:"flex justify-center",children:n.jsxs("div",{className:"flex flex-1 flex-col items-center space-y-3",children:[a("create_recurring_invoice")&&n.jsx(C,{label:t("recurring_invoice"),icon:$,onClick:f}),a("create_quote")&&n.jsx(C,{label:t("quote"),icon:z,onClick:k}),a("create_credit")&&n.jsx(C,{label:t("credit"),icon:G,onClick:j}),a("create_purchase_order")&&n.jsx(C,{label:t("purchase_order"),icon:J,onClick:b})]})})})]})}const Me=d=>{var t;return d.balance>0&&(d.status_id===_.Sent||d.status_id===_.Partial)&&!!((t=d.client)!=null&&t.gateway_tokens.length)};function we(d){const{t}=A(),{showEditAction:r,showCommonBulkAction:s,dropdown:i=!0}=d||{},a=L(),{isAdmin:v,isOwner:u}=X(),{isEditPage:l}=U({entity:"invoice",editPageTabs:["documents","settings","activity","history","email_history"]}),c=W(),m=M(),x=D(),h=Z({resource:"invoice"}),k=ee({resource:"invoice"}),j=te({entity:"invoice"}),f=ie({entity:"invoice"}),{setChangeTemplateVisible:b,setChangeTemplateResources:K,setChangeTemplateEntityContext:N}=ne(),B=y(oe),Y=e=>{B({...e,id:"",number:"",documents:[],due_date:"",date:g().format("YYYY-MM-DD"),total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0}),m("/invoices/create?action=clone")};return[e=>!!r&&n.jsx(ae,{to:p("/invoices/:id/edit",{id:e.id}),icon:n.jsx(se,{element:ce}),children:t("edit")}),()=>!!r&&i&&n.jsx(P,{withoutPadding:!0}),e=>n.jsx(Pe,{...!i&&{key:"email_invoice"},invoice:e,isDropdown:i}),e=>n.jsx(o,{...!i&&{key:"view_pdf"},entity:"invoice",actionKey:"view_pdf",isCommonActionSection:!i,tooltipText:t("view_pdf"),to:p("/invoices/:id/pdf",{id:e.id}),icon:S,children:t("view_pdf")}),e=>de(e)!==le.Deleted&&n.jsx(o,{...!i&&{key:"print_pdf"},entity:"invoice",actionKey:"print_pdf",isCommonActionSection:!i,tooltipText:t("print_pdf"),onClick:()=>j([e.id]),icon:re,disablePreventNavigation:!0,children:t("print_pdf")}),e=>e.status_id!==_.Paid&&(v||u)&&n.jsx(o,{...!i&&{key:"schedule"},entity:"invoice",actionKey:"schedule",isCommonActionSection:!i,tooltipText:t("schedule"),onClick:()=>f(e.id),icon:_e,children:t("schedule")}),e=>n.jsxs(o,{...!i&&{key:"delivery_note"},entity:"invoice",actionKey:"delivery_note",isCommonActionSection:!i,tooltipText:`${t("delivery_note")} ${t("pdf")}`,to:p("/invoices/:id/pdf?delivery_note=true",{id:e.id}),icon:S,children:[t("delivery_note")," (",t("pdf"),")"]}),e=>n.jsx(o,{...!i&&{key:"download"},entity:"invoice",actionKey:"download",isCommonActionSection:!i,tooltipText:t("download"),onClick:()=>h(e),icon:T,disablePreventNavigation:!0,children:t("download")}),e=>!!(a!=null&&a.settings.enable_e_invoice)&&n.jsx(o,{...!i&&{key:"download_e_invoice"},entity:"invoice",actionKey:"download_e_invoice",isCommonActionSection:!i,tooltipText:t("download_e_invoice"),onClick:()=>k(e),icon:T,disablePreventNavigation:!0,children:t("download_e_invoice")}),e=>n.jsx(ue,{...!i&&{key:"add_comment"},entity:"invoice",entityId:e.id,label:e.number,labelElement:n.jsx(o,{entity:"invoice",actionKey:"add_comment",isCommonActionSection:!i,tooltipText:t("add_comment"),icon:me,disablePreventNavigation:!0,children:t("add_comment")})}),e=>e.status_id===_.Draft&&!e.is_deleted&&n.jsx(o,{...!i&&{key:"mark_sent"},entity:"invoice",actionKey:"mark_sent",isCommonActionSection:!i,tooltipText:t("mark_sent"),onClick:()=>c([e.id],"mark_sent"),icon:pe,disablePreventNavigation:!0,children:t("mark_sent")}),e=>parseInt(e.status_id)<parseInt(_.Paid)&&!e.is_deleted&&n.jsx(o,{...!i&&{key:"mark_paid"},entity:"invoice",actionKey:"mark_paid",isCommonActionSection:!i,tooltipText:t("mark_paid"),onClick:()=>c([e.id],"mark_paid"),icon:ve,disablePreventNavigation:!0,children:t("mark_paid")}),e=>Me(e)&&n.jsx(o,{...!i&&{key:"auto_bill"},entity:"invoice",actionKey:"auto_bill",isCommonActionSection:!i,tooltipText:t("auto_bill"),onClick:()=>c([e.id],"auto_bill"),icon:ye,disablePreventNavigation:!0,children:t("auto_bill")}),e=>parseInt(e.status_id)<4&&x("create_payment")&&n.jsx(o,{...!i&&{key:"enter_payment"},entity:"invoice",actionKey:"enter_payment",isCommonActionSection:!i,tooltipText:t("enter_payment"),to:p("/payments/create?invoice=:invoiceId&client=:clientId",{invoiceId:e.id,clientId:e.client_id}),icon:xe,children:t("enter_payment")}),e=>n.jsx(o,{...!i&&{key:"client_portal"},entity:"invoice",actionKey:"client_portal",isCommonActionSection:!i,tooltipText:t("client_portal"),onClick:()=>e&&Ce(e),icon:he,disablePreventNavigation:!0,children:t("client_portal")}),e=>n.jsx(o,{...!i&&{key:"run_template"},entity:"invoice",actionKey:"run_template",isCommonActionSection:!i,tooltipText:t("run_template"),onClick:()=>{b(!0),K([e]),N({endpoint:"/api/v1/invoices/bulk",entity:"invoice"})},icon:ge,children:t("run_template")}),()=>i&&n.jsx(P,{withoutPadding:!0}),e=>x("create_invoice")&&n.jsx(o,{...!i&&{key:"clone_to_invoice"},entity:"invoice",actionKey:"clone_to_invoice",isCommonActionSection:!i,tooltipText:t("clone_to_invoice"),onClick:()=>Y(e),icon:E,children:t("clone_to_invoice")}),e=>n.jsx(Ae,{...!i&&{key:"clone_to_other"},dropdown:i,invoice:e}),()=>(l||!!s)&&i&&n.jsx(P,{withoutPadding:!0}),e=>(l||!!s)&&e.archived_at===0&&n.jsx(o,{...!i&&{key:"archive"},entity:"invoice",actionKey:"archive",isCommonActionSection:!i,tooltipText:t("archive"),onClick:()=>c([e.id],"archive"),icon:ke,excludePreferences:!0,disablePreventNavigation:!0,children:t("archive")}),e=>(l||!!s)&&e.archived_at>0&&e.status_id!==_.Cancelled&&n.jsx(o,{...!i&&{key:"restore"},entity:"invoice",actionKey:"restore",isCommonActionSection:!i,tooltipText:t("restore"),onClick:()=>c([e.id],"restore"),icon:je,excludePreferences:!0,disablePreventNavigation:!0,children:t("restore")}),e=>(l||!!s)&&!e.is_deleted&&n.jsx(o,{...!i&&{key:"delete"},entity:"invoice",actionKey:"delete",isCommonActionSection:!i,tooltipText:t("delete"),onClick:()=>c([e.id],"delete"),icon:fe,excludePreferences:!0,disablePreventNavigation:!0,children:t("delete")}),e=>(e.status_id===_.Sent||e.status_id===_.Partial)&&n.jsx(o,{entity:"invoice",actionKey:"cancel_invoice",isCommonActionSection:!i,tooltipText:t("cancel_invoice"),onClick:()=>c([e.id],"cancel"),icon:be,disablePreventNavigation:!0,children:t("cancel_invoice")},"cancel_invoice")]}export{Me as i,we as u};
