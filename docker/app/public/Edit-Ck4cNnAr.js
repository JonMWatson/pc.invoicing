import{u as w,a as S,bK as F,a7 as D,cm as E,w as R,Z as A,bY as V,a1 as U,j as e,C as $,cn as M,ax as O,co as B,i as G,bt as K,cp as h,c9 as i,S as C,a5 as Y,a6 as Z}from"./bundle.D3-hVUGj.js";import{C as q}from"./ClientSelector-DtB3q7fn.js";import{I as z,a as H}from"./InvoiceFooter-CunZMX-C.js";import{u as J,I as Q,a as W}from"./useProductColumns-BqpEcmPs.js";import{u as X}from"./useTaskColumns-DD2_WhOx.js";import{u as ee}from"./useInvoiceUtilities-CJ61_NPN.js";import{I as se}from"./InvoiceStatus-CQhnxHGD.js";import"./ClientActionButtons-YTWpr-RA.js";import"./InvoiceViewer-CknzAqf8.js";import"./invoice-status-We6cAxTk.js";function pe(){const[n]=w(),l=S(),[r]=F(),j=D(),v=E(),{invoice:s,isDefaultTerms:I,setIsDefaultTerms:g,isDefaultFooter:y,setIsDefaultFooter:f,errors:o,client:c}=v,b=X(),m=R(),k=J(),[T]=A(V),{handleChange:a,handleInvitationChange:_,handleLineItemChange:d,handleLineItemPropertyChange:p,handleCreateLineItem:u,handleDeleteLineItem:x}=ee({client:c}),{changeTemplateVisible:L,setChangeTemplateVisible:N}=U();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx($,{className:"col-span-12 xl:col-span-4 h-max px-6 py-2 shadow-sm",style:{borderColor:l.$24},children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[s&&e.jsxs("div",{className:"flex items-center space-x-9",children:[e.jsx("span",{className:"text-sm font-medium",style:{color:l.$22},children:n("status")}),e.jsx("div",{children:e.jsx(se,{entity:s})})]}),e.jsx(M,{entityId:s==null?void 0:s.project_id,cacheEndpoint:"/api/v1/projects",apiEndpoint:"/api/v1/projects/:id?include=client",componentCallbackFn:t=>e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",style:{color:l.$22},children:[n("project"),":"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm",children:t.name}),e.jsx("div",{className:"cursor-pointer",onClick:()=>j(G("/projects/:id",{id:s==null?void 0:s.project_id})),children:e.jsx(O,{element:B,style:{width:"1.17rem",height:"1.17rem"}})})]})]})}),e.jsx(q,{resource:s,onChange:t=>a("client_id",t),onClearButtonClick:()=>a("client_id",""),onLocationChange:t=>a("location_id",t),onContactCheckboxChange:_,errorMessage:o==null?void 0:o.errors.client_id,textOnly:!0,readonly:!0})]})}),e.jsx(z,{invoice:s,handleChange:a,errors:o}),e.jsx("div",{className:"col-span-12",children:e.jsxs(K,{tabs:[n("products"),n("tasks")],defaultTabIndex:r.get("table")==="tasks"?1:0,children:[e.jsx("div",{children:s&&c?e.jsx(h,{type:"product",resource:s,shouldCreateInitialLineItem:r.get("table")!=="tasks",items:s.line_items.filter(t=>[i.Product,i.UnpaidFee,i.PaidFee,i.LateFee].includes(t.type_id)),columns:k,relationType:"client_id",onLineItemChange:d,onSort:t=>a("line_items",t),onLineItemPropertyChange:p,onCreateItemClick:()=>u(i.Product),onDeleteRowClick:x}):e.jsx(C,{})}),e.jsx("div",{children:s&&c?e.jsx(h,{type:"task",resource:s,shouldCreateInitialLineItem:r.get("table")==="tasks",items:s.line_items.filter(t=>t.type_id===i.Task),columns:b,relationType:"client_id",onLineItemChange:d,onSort:t=>a("line_items",t),onLineItemPropertyChange:p,onCreateItemClick:()=>u(i.Task),onDeleteRowClick:x}):e.jsx(C,{})})]})}),e.jsx(H,{invoice:s,handleChange:a,errors:o,isDefaultFooter:y,isDefaultTerms:I,setIsDefaultFooter:f,setIsDefaultTerms:g}),s&&e.jsx(Q,{relationType:"client_id",resource:s,invoiceSum:T,onChange:(t,P)=>a(t,P)})]}),(m==null?void 0:m.show_pdf_preview)&&e.jsx("div",{className:"my-4",children:s&&e.jsx(W,{for:"invoice",resource:s,entity:"invoice",relationType:"client_id",endpoint:"/api/v1/live_preview?entity=:entity",observable:!0,initiallyVisible:!1,withRemoveLogoCTA:!0})}),s?e.jsx(Y,{entity:"invoice",entities:[s],visible:L,setVisible:N,labelFn:t=>e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx(Z,{children:n("number")}),e.jsx("span",{children:t.number})]}),bulkUrl:"/api/v1/invoices/bulk"}):null]})}export{pe as default};
