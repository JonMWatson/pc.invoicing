import{u as B,a as E,p as o,a7 as k,eo as D,cx as P,cy as T,bd as p,r as V,e as $,$ as w,i as F,j as a,dW as R,g3 as q,C as x,bu as c,ct as A,fy as I,cr as M,g8 as N}from"./bundle.D3-hVUGj.js";import{D as L}from"./DesignSelector-CU77NKZ6.js";import{u as O}from"./designs-Cr-Aj-yC.js";const Q=["invoice","payment","client","quote","credit","purchase_order","project","task"];function H(){const{t:i}=B(),m=E(),{data:g}=O(),[n,l]=o.useState(null),[h,f]=o.useState(!1),[t,b]=o.useState(null),y=(e,s)=>{l(d=>d&&{...d,[e]:s})};o.useEffect(()=>(g&&l(g),()=>l(null)),[g]);const C=k();D({onClick(){h||(f(!0),p.processing(),b(null),V("POST",$("/api/v1/designs"),n).then(e=>{p.success("design_created"),w(["designs"]),C(F("/settings/invoice_design/custom_designs/:id/edit",{id:e.data.data.id}))}).catch(e=>{var s;((s=e.response)==null?void 0:s.status)===422&&(p.dismiss(),b(e.response.data))}).finally(()=>f(!1)))},disableSaveButton:!P()&&!T()||h},[n,h]);const[r,S]=o.useState("design"),v=e=>{if(e==="template"){l(s=>s&&{...s,is_template:!0,design:{...s.design,header:" ",body:s.design.body.length>0?s.design.body:`<html>
	<head>
	</head>
	<body>
		<ninja>

		</ninja>
	</body>
</html>
`,footer:" ",includes:" "}});return}if(e==="design"){l(s=>s&&{...s,is_template:!1,design:{...s.design,header:"",body:"",footer:"",includes:""},entities:""});return}},_=(e,s)=>{if(!n)return;const j=(n.entities.length>1?n.entities.split(",")||[]:[]).filter(u=>u!==e);s&&j.push(e),l(u=>u&&{...u,entities:j.join(",")})};return a.jsxs(R,{breadcrumbs:[],children:[a.jsx(q,{}),a.jsxs(x,{title:i("new_design"),className:"shadow-sm pb-4",style:{borderColor:m.$24},headerStyle:{borderColor:m.$20},children:[a.jsx(c,{leftSide:i("name"),children:a.jsx(A,{value:n==null?void 0:n.name,errorMessage:t==null?void 0:t.errors.name,onValueChange:e=>y("name",e)})}),a.jsx(c,{leftSide:i("type"),children:a.jsx(I,{name:"type",options:[{id:"design",title:i("design"),value:"design"},{id:"template",title:i("template"),value:"template"}],defaultSelected:r,onValueChange:e=>{S(e),v(e)}})}),r==="design"?a.jsx(c,{leftSide:i("design"),children:a.jsx(L,{onChange:e=>y("design",e.design),actionVisibility:!1,errorMessage:(t==null?void 0:t.errors["design.header"])||(t==null?void 0:t.errors["design.body"])||(t==null?void 0:t.errors["design.footer"])||(t==null?void 0:t.errors["design.includes"])})}):null,r==="template"?a.jsx(c,{leftSide:i("resource"),children:Q.map(e=>a.jsx(M,{label:i(e),value:e,onValueChange:(s,d)=>_(s,!!d),checked:n==null?void 0:n.entities.includes(e)},e))}):null]}),r==="template"?a.jsx(x,{title:i("import"),withContainer:!0,collapsed:!0,children:a.jsx(N,{height:"15rem",defaultLanguage:"html",value:n==null?void 0:n.design.body,options:{minimap:{enabled:!1}},onChange:e=>e&&l(s=>s&&{...s,design:{...s.design,body:e}})})}):null]})}export{H as default,Q as templateEntites};
