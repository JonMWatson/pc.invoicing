import{u as b,t as D,Y as x,bp as p,bO as j,i as r,j as i,bP as I,L as N,bW as w,e9 as O,Z as F,ag as L,bI as V,ee as k,p as d,ef as M,eg as Q,bc as H,bi as U,Q as W,bR as Y,bS as Z,S as q,e8 as z,d2 as G,bA as J}from"./bundle.D3-hVUGj.js";import{C as K}from"./CommonActions-DKlnNCPW.js";import{P as X}from"./PreviousNextNavigation-BpWEW6Fs.js";import{B as $}from"./Banner-C9ETM0xV.js";import"./Actions-OZ_Df7fS.js";import"./invoice-status-We6cAxTk.js";import"./hooks-DdpVpzmL.js";import"./CreditStatus-DFPZx7rF.js";import"./useInvoiceColumns-YKQxY9Gc.js";import"./InvoiceStatus-CQhnxHGD.js";function ee(v){var a;const[t]=b(),s=D(),m=x(),o=p(),{id:n}=j(),{recurringInvoice:c}=v,g=m("view_recurring_invoice")||m("edit_recurring_invoice")||o(c);return[{name:t("edit"),href:r("/recurring_invoices/:id/edit",{id:n})},{name:t("e_invoice"),href:r("/recurring_invoices/:id/e_invoice",{id:n}),enabled:!!((s==null?void 0:s.settings.e_invoice_type)==="PEPPOL"&&(s!=null&&s.settings.enable_e_invoice)&&((a=s==null?void 0:s.tax_data)!=null&&a.acts_as_sender))},{name:t("documents"),href:r("/recurring_invoices/:id/documents",{id:n}),enabled:g,formatName:()=>{var l;return i.jsx(I,{numberOfDocuments:(l=c==null?void 0:c.documents)==null?void 0:l.length})}},{name:t("settings"),href:r("/recurring_invoices/:id/settings",{id:n})},{name:t("activity"),href:r("/recurring_invoices/:id/activity",{id:n})},{name:t("history"),href:r("/recurring_invoices/:id/history",{id:n})},{name:t("schedule"),href:r("/recurring_invoices/:id/schedule",{id:n})}]}function me(){const{documentTitle:v}=N("edit_recurring_invoice"),[t]=b(),{id:s}=j(),m=w(),{data:o}=O({id:s}),n=x(),c=p(),g=[{name:t("recurring_invoices"),href:"/recurring_invoices"},{name:t("edit_recurring_invoice"),href:r("/recurring_invoices/:id/edit",{id:s})}],[e,a]=F(L),{visible:l,refetchEntityId:y,refetchEntity:A}=V(k),[_,E]=d.useState(),[S,R]=d.useState(),[f,B]=d.useState(!1),h=M({setErrors:R,setIsFormBusy:B,isFormBusy:f}),P=ee({recurringInvoice:e}),{calculateInvoiceSum:C}=Q({client:_});return d.useEffect(()=>{if(o){const u=H.cloneDeep(o);u.line_items.map(T=>T._id=U()),a(u),u&&u.client&&E(u.client)}},[o]),d.useEffect(()=>{e&&C(e)},[e]),i.jsxs(W,{title:v,breadcrumbs:g,...(n("edit_recurring_invoice")||c(e))&&e&&{navigationTopRight:i.jsx(J,{resource:e,onSaveClick:()=>h(e),actions:m,cypressRef:"recurringInvoiceActionDropdown",disableSaveButton:f})},aboveMainContainer:!!(l&&y===s&&A==="recurring_invoices")&&i.jsx($,{variant:"orange",children:t("invoice_status_changed")}),afterBreadcrumbs:i.jsx(X,{entity:"recurring_invoice"}),children:[(e==null?void 0:e.id)===s?i.jsxs("div",{className:"space-y-4",children:[i.jsx(Y,{tabs:P,rightSide:e&&i.jsx("div",{className:"flex items-center",children:i.jsx(K,{resource:e,entity:"recurring_invoice"})})}),i.jsx(Z,{context:{recurringInvoice:e,setRecurringInvoice:a,errors:S,client:_}})]}):i.jsx("div",{className:"flex justify-center items-center",children:i.jsx(q,{})}),(e==null?void 0:e.status_id)===z.DRAFT?i.jsx(G,{onClick:()=>h(e,"send_now")}):null]})}export{me as default};
