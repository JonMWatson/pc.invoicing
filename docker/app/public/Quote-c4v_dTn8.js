import{u as q,Y as y,bp as j,bO as g,i as n,j as s,bP as L,L as V,bU as k,bQ as w,ad as O,Z as U,et as H,p as o,eu as M,ev as W,a1 as Y,bc as Z,bi as z,Q as G,bR as J,bS as K,S as X,a5 as $,a6 as ee,bA as se}from"./bundle.D3-hVUGj.js";import{u as te}from"./queries-B9zpGE70.js";import{C as ie}from"./CommonActions-DKlnNCPW.js";import{P as ae}from"./PreviousNextNavigation-BpWEW6Fs.js";import"./Actions-OZ_Df7fS.js";import"./invoice-status-We6cAxTk.js";import"./hooks-DdpVpzmL.js";import"./CreditStatus-DFPZx7rF.js";import"./useInvoiceColumns-YKQxY9Gc.js";import"./InvoiceStatus-CQhnxHGD.js";function oe(l){const[t]=q(),r=y(),d=j(),{id:i}=g(),{quote:u}=l,f=r("view_quote")||r("edit_quote")||d(u);return[{name:t("edit"),href:n("/quotes/:id/edit",{id:i})},{name:t("documents"),href:n("/quotes/:id/documents",{id:i}),enabled:f,formatName:()=>{var m;return s.jsx(L,{numberOfDocuments:(m=u==null?void 0:u.documents)==null?void 0:m.length})}},{name:t("settings"),href:n("/quotes/:id/settings",{id:i})},{name:t("activity"),href:n("/quotes/:id/activity",{id:i})},{name:t("history"),href:n("/quotes/:id/history",{id:i})},{name:t("email_history"),href:n("/quotes/:id/email_history",{id:i})}]}function he(){const{documentTitle:l}=V("edit_quote"),[t]=q(),{id:r}=g(),d=k(),i=y(),u=j(),f=[{name:t("quotes"),href:"/quotes"},{name:t("edit_quote"),href:n("/quotes/:id/edit",{id:r})}],{data:c,isLoading:m}=te({id:r}),[e,b]=w(O),[S]=U(H),[p,T]=o.useState(),[A,_]=o.useState(),[h,D]=o.useState(!1),[x,E]=o.useState(!1),[v,P]=o.useState(!1),C=oe({quote:e}),N=M({setErrors:_,isDefaultFooter:v,isDefaultTerms:x,isFormBusy:h,setIsFormBusy:D}),{calculateInvoiceSum:Q}=W({client:p}),{changeTemplateVisible:R,setChangeTemplateVisible:F,changeTemplateResources:I}=Y();return o.useEffect(()=>{if(c){const a=Z.cloneDeep(c);a.line_items.map(B=>B._id=z()),b(a),a&&a.client&&T(a.client)}},[c]),o.useEffect(()=>{e&&Q(e)},[e]),s.jsxs(G,{title:l,breadcrumbs:f,...(i("edit_quote")||u(e))&&e&&{navigationTopRight:s.jsx(se,{resource:e,actions:d,onSaveClick:()=>e&&N(e),disableSaveButton:!e||h,cypressRef:"quoteActionDropdown"})},afterBreadcrumbs:s.jsx(ae,{entity:"quote"}),children:[(e==null?void 0:e.id)===r||!m?s.jsxs("div",{className:"space-y-4",children:[s.jsx(J,{tabs:C,rightSide:e&&s.jsx("div",{className:"flex items-center",children:s.jsx(ie,{resource:e,entity:"quote"})})}),s.jsx(K,{context:{quote:e,setQuote:b,errors:A,isDefaultTerms:x,setIsDefaultTerms:E,isDefaultFooter:v,setIsDefaultFooter:P,client:p,invoiceSum:S}})]}):s.jsx("div",{className:"flex justify-center items-center",children:s.jsx(X,{})}),s.jsx($,{entity:"quote",entities:I,visible:R,setVisible:F,labelFn:a=>s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx(ee,{children:t("number")}),s.jsx("span",{children:a.number})]}),bulkUrl:"/api/v1/quotes/bulk"})]})}export{he as default};
