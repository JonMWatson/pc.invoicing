import{u as C,db as k,a as P,j as t,aa as g,bh as q,t as y,H as B,a7 as A,p as f,aw as m,ax as v,a9 as N,ab as M,i as D,dc as F,Y as O,at as Q,a1 as V,aD as H,aF as w,cn as $,dd as W,bd as Y,aI as z,de as G,df as J,aO as K,dg as p,bj as L,w as U,dh as X}from"./bundle.D3-hVUGj.js";import{u as Z}from"./useDownloadPdfs-C_Q3GnYI.js";import{u as R}from"./useSumTableColumn-CIYkE3cT.js";function ee(){const s=y(),o=[{label:"initial_email",value:"quote"},{label:"reminder1",value:"reminder1"}];return s!=null&&s.settings.email_subject_custom1&&o.push({label:s==null?void 0:s.settings.email_subject_custom1,value:"custom1"}),s!=null&&s.settings.email_subject_custom2&&o.push({label:s==null?void 0:s.settings.email_subject_custom2,value:"custom2"}),s!=null&&s.settings.email_subject_custom3&&o.push({label:s==null?void 0:s.settings.email_subject_custom3,value:"custom3"}),o}const te=B.div`
  &:hover {
    background-color: ${s=>s.theme.hoverColor};
  }
`;function se(s){const{visible:o,setVisible:l,quoteIds:i}=s,[d]=C(),r=k({onSuccess:()=>l(!1)}),u=P(),h=ee();return t.jsx(g,{title:q("email_count_quotes",{count:i.length}),visible:o,onClose:()=>l(!1),children:t.jsx("div",{children:h.map((x,j)=>t.jsx(te,{className:"flex justify-between py-2 cursor-pointer pl-2",onClick:()=>{r(i,"email",{email_type:x.value}),s.setSelected([])},theme:{hoverColor:u.$5},children:d(x.label)},j))})})}const ne=s=>{const{selectedQuotes:o,setSelected:l}=s,[i]=C(),d=A(),[r,u]=f.useState(!1),[h,x]=f.useState(!1),j=()=>o.every(({client:a})=>a==null?void 0:a.contacts.some(({email:_})=>_)),b=()=>o.find(({client:a})=>!(a!=null&&a.contacts.some(({email:_})=>_)));return t.jsxs(t.Fragment,{children:[t.jsx(se,{visible:r,setVisible:u,quoteIds:o.map(({id:a})=>a),setSelected:l}),t.jsx(m,{onClick:()=>j()?u(!0):x(!0),icon:t.jsx(v,{element:N}),children:i("send_email")}),t.jsx(g,{title:i("contact_email"),visible:h,onClose:()=>x(!1),children:t.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[t.jsxs("span",{className:"text-base font-medium",children:[i("client_email_not_set"),"."]}),t.jsx(M,{className:"self-end",onClick:()=>{var a;d(D("/clients/:id/edit",{id:(a=b())==null?void 0:a.client_id})),x(!1)},children:i("edit_client")})]})})]})},oe=s=>{const[o]=C(),[l,i]=f.useState(!1),{selectedIds:d,setSelected:r}=s,u=k();return t.jsxs(t.Fragment,{children:[t.jsx(m,{onClick:()=>i(!0),icon:t.jsx(v,{element:F}),children:o("convert_to_invoice")}),t.jsxs(g,{title:o("convert_to_invoice"),visible:l,onClose:()=>i(!1),children:[t.jsx("span",{className:"text-lg text-gray-900",children:o("are_you_sure")}),t.jsx("div",{className:"flex justify-end space-x-4 mt-5",children:t.jsx(M,{behavior:"button",onClick:()=>{u(d,"convert_to_invoice"),r([]),i(!1)},children:t.jsx("span",{className:"text-base mx-3",children:o("yes")})})})]})]})};function ue(){const[s]=C(),o=A(),l=O(),i=Q({entity:"quote"}),d=Z({entity:"quote"}),r=k(),u=L(),h=e=>e.every(({status_id:n})=>n===p.Draft||n===p.Sent),x=e=>e.every(({status_id:n})=>n!==p.Converted),j=e=>e.every(({project_id:n})=>!n),b=e=>e.every(({status_id:n})=>n===p.Draft),a=e=>e.some(({documents:n})=>n.length),_=e=>e.flatMap(({documents:n})=>n.map(({id:c})=>c)),T=(e,n)=>{const c=_(e);u(c,"download"),n==null||n([])},{setChangeTemplateVisible:E,setChangeTemplateResources:I,setChangeTemplateEntityContext:S}=V();return[({selectedIds:e,selectedResources:n,setSelected:c})=>t.jsx(ne,{selectedIds:e,selectedQuotes:n,setSelected:c}),({selectedIds:e,setSelected:n})=>t.jsx(m,{onClick:()=>{i(e),n([])},icon:t.jsx(v,{element:H}),children:s("print_pdf")}),({selectedIds:e,setSelected:n})=>t.jsx(m,{onClick:()=>{d(e),n([])},icon:t.jsx(v,{element:w}),children:s("download_pdf")}),({selectedResources:e})=>(e==null?void 0:e.length)&&e[0].invoice_id&&t.jsx($,{entityId:e[0].invoice_id,cacheEndpoint:"/api/v1/invoices",apiEndpoint:"/api/v1/invoices/:id?include=client.group_settings",preCheck:l("view_invoice")||l("edit_invoice"),component:t.jsx(m,{onClick:()=>o(D("/invoices/:id/edit",{id:e[0].invoice_id})),icon:t.jsx(v,{element:W}),children:s("view_invoice")})}),({selectedResources:e,setSelected:n})=>t.jsx(m,{onClick:()=>e&&a(e)?T(e,n):Y.error("no_documents_to_download"),icon:t.jsx(v,{element:w}),children:s("documents")}),({selectedIds:e,selectedResources:n,setSelected:c})=>n&&b(n)&&t.jsx(m,{onClick:()=>{r(e,"mark_sent"),c([])},icon:t.jsx(v,{element:z}),children:s("mark_sent")}),({selectedIds:e,selectedResources:n,setSelected:c})=>n&&h(n)&&t.jsx(m,{onClick:()=>{r(e,"approve"),c([])},icon:t.jsx(v,{element:G}),children:s("approve")}),({selectedIds:e,selectedResources:n,setSelected:c})=>n&&x(n)&&l("create_invoice")&&t.jsx(oe,{selectedIds:e,setSelected:c}),({selectedIds:e,selectedResources:n,setSelected:c})=>n&&j(n)&&l("create_project")&&t.jsx(J,{selectedIds:e,setSelected:c,dropdown:!0}),({selectedResources:e})=>t.jsx(m,{onClick:()=>{E(!0),I(e),S({endpoint:"/api/v1/quotes/bulk",entity:"quote"})},icon:t.jsx(v,{element:K}),children:s("run_template")})]}/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function re(){var r;const[s]=C(),o=U();X();const l=R(),i=[{column:"amount",id:"amount",label:s("amount"),format:(u,h)=>l(u,h)}],d=((r=o==null?void 0:o.table_footer_columns)==null?void 0:r.quote)||[];return{footerColumns:i.filter(({id:u})=>d.includes(u)),allFooterColumns:i}}export{ue as a,re as u};
