import{u as P,a as w,bK as S,cm as D,w as F,j as e,C as N,bt as R,cp as p,c9 as a,S as C}from"./bundle.D3-hVUGj.js";import{C as U}from"./ClientSelector-DtB3q7fn.js";import{I as B,a as E}from"./InvoiceFooter-CunZMX-C.js";import{u as G,I as K,a as M}from"./useProductColumns-BqpEcmPs.js";import{u as O}from"./useTaskColumns-DD2_WhOx.js";import{u as V}from"./useInvoiceUtilities-CJ61_NPN.js";import"./ClientActionButtons-YTWpr-RA.js";import"./InvoiceViewer-CknzAqf8.js";function X(){const[l]=P(),h=w(),[i]=S(),x=D(),{invoice:n,errors:o,client:I,invoiceSum:_,isDefaultFooter:g,isDefaultTerms:v,setIsDefaultFooter:j,setIsDefaultTerms:y}=x,f=O(),r=F(),b=G(),{handleChange:t,handleInvitationChange:k,handleLineItemChange:c,handleLineItemPropertyChange:m,handleCreateLineItem:d,handleDeleteLineItem:u}=V({client:I}),T=()=>(t("client_id",""),t("location_id",""),t("tax_name1",""),t("tax_rate1",0),t("tax_name2",""),t("tax_rate2",0),t("tax_name3",""),t("tax_rate3",0),!0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx(N,{className:"col-span-12 xl:col-span-4 h-max shadow-sm",withContainer:!0,style:{borderColor:h.$24},children:e.jsx(U,{resource:n,onChange:s=>t("client_id",s),onLocationChange:s=>t("location_id",s),onClearButtonClick:T,onContactCheckboxChange:k,readonly:i.get("project")==="true",errorMessage:o==null?void 0:o.errors.client_id,disableWithSpinner:i.get("action")==="create"})}),e.jsx(B,{invoice:n,handleChange:t,errors:o}),e.jsx("div",{className:"col-span-12",children:e.jsxs(R,{tabs:[l("products"),l("tasks")],defaultTabIndex:i.get("table")==="tasks"?1:0,children:[e.jsx("div",{children:n?e.jsx(p,{type:"product",resource:n,shouldCreateInitialLineItem:i.get("table")!=="tasks",items:n.line_items.filter(s=>[a.Product,a.UnpaidFee,a.PaidFee,a.LateFee].includes(s.type_id)),columns:b,relationType:"client_id",onLineItemChange:c,onSort:s=>t("line_items",s),onLineItemPropertyChange:m,onCreateItemClick:()=>d(a.Product),onDeleteRowClick:u}):e.jsx(C,{})}),e.jsx("div",{children:n?e.jsx(p,{type:"task",resource:n,shouldCreateInitialLineItem:i.get("table")==="tasks",items:n.line_items.filter(s=>s.type_id===a.Task),columns:f,relationType:"client_id",onLineItemChange:c,onSort:s=>t("line_items",s),onLineItemPropertyChange:m,onCreateItemClick:()=>d(a.Task),onDeleteRowClick:u}):e.jsx(C,{})})]})}),e.jsx(E,{invoice:n,handleChange:t,errors:o,isDefaultFooter:g,isDefaultTerms:v,setIsDefaultFooter:j,setIsDefaultTerms:y}),n&&e.jsx(K,{relationType:"client_id",resource:n,invoiceSum:_,onChange:(s,L)=>t(s,L)})]}),(r==null?void 0:r.show_pdf_preview)&&e.jsx("div",{className:"my-4",children:n&&e.jsx(M,{for:"create",resource:n,entity:"invoice",relationType:"client_id",endpoint:"/api/v1/live_preview?entity=:entity",observable:!0,initiallyVisible:!1})})]})}export{X as default};
