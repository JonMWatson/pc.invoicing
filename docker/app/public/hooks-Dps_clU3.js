import{u as y,f as H,aT as L,g as R,aV as V,d as O,w as z,aW as E,j as s,l as g,D as T,i as D,aZ as P,a_ as M,a$ as k,b0 as A,aY as Y,a7 as q,Y as S,dp as Q,dq as F,ap as W,ac as Z,a1 as N,aw as u,ax as m,bF as B,ai as $,aO as I,az as G,aB as f,aC as C,aP as J,aQ as K,aR as U,bd as X,aF as ee,bj as te}from"./bundle.D3-hVUGj.js";import{p as oe}from"./atoms-CQqBLmIS.js";const se=["name","task_rate","due_date","public_notes","private_notes","budgeted_hours","entity_state"];function ne(){const[o,c,r,l]=E({entity:"project"});return["name","client","task_rate","due_date","public_notes","private_notes","budgeted_hours","entity_state","archived_at","created_at",o,c,r,l,"documents","is_deleted","number","updated_at","total_hours"]}function ce(){var b;const{t:o}=y(),{dateFormat:c}=H(),r=L(),l=R(),d=V(),_=O(),i=z();ne();const[p,h,j,x]=E({entity:"project"}),a=[{column:"name",id:"name",label:o("name"),format:(e,n)=>s.jsx(T,{to:D("/projects/:id",{id:n.id}),renderSpan:l("project",n),children:e})},{column:"client",id:"client_id",label:o("client"),format:(e,n)=>n.client&&s.jsx(T,{to:D("/clients/:id",{id:e.toString()}),renderSpan:l("client",n.client),children:n.client.display_name})},{column:"task_rate",id:"task_rate",label:o("task_rate"),format:(e,n)=>{var v,w;return _(e,(v=n.client)==null?void 0:v.country_id,(w=n.client)==null?void 0:w.settings.currency_id)}},{column:"due_date",id:"due_date",label:o("due_date"),format:e=>g(e,c)},{column:"public_notes",id:"public_notes",label:o("public_notes"),format:e=>s.jsx(P,{width:"auto",tooltipElement:s.jsx("div",{className:"w-full max-h-48 overflow-auto whitespace-normal break-all",children:s.jsx("article",{className:A("prose prose-sm",{"prose-invert":!(i!=null&&i.dark_mode)}),dangerouslySetInnerHTML:{__html:k(e)}})}),children:s.jsx("span",{children:M(k(e)).slice(0,50)})})},{column:"private_notes",id:"private_notes",label:o("private_notes"),format:e=>s.jsx(P,{width:"auto",tooltipElement:s.jsx("div",{className:"w-full max-h-48 overflow-auto whitespace-normal break-all",children:s.jsx("article",{className:A("prose prose-sm",{"prose-invert":!(i!=null&&i.dark_mode)}),dangerouslySetInnerHTML:{__html:k(e)}})}),children:s.jsx("span",{children:M(k(e)).slice(0,50)})})},{column:"budgeted_hours",id:"budgeted_hours",label:o("budgeted_hours"),format:e=>r(e)},{column:"total_hours",id:"current_hours",label:o("total_hours"),format:e=>r(e)},{column:"entity_state",id:"id",label:o("entity_state"),format:(e,n)=>s.jsx(Y,{entity:n})},{column:"archived_at",id:"archived_at",label:o("archived_at"),format:e=>g(e,c)},{column:"created_at",id:"created_at",label:o("created_at"),format:e=>g(e,c)},{column:p,id:"custom_value1",label:p,format:e=>d("project1",e==null?void 0:e.toString())},{column:h,id:"custom_value2",label:h,format:e=>d("project2",e==null?void 0:e.toString())},{column:j,id:"custom_value3",label:j,format:e=>d("project3",e==null?void 0:e.toString())},{column:x,id:"custom_value4",label:x,format:e=>d("project4",e==null?void 0:e.toString())},{column:"documents",id:"documents",label:o("documents"),format:(e,n)=>n.documents.length},{column:"is_deleted",id:"is_deleted",label:o("is_deleted"),format:(e,n)=>n.is_deleted?o("yes"):o("no")},{column:"number",id:"number",label:o("number")},{column:"updated_at",id:"updated_at",label:o("updated_at"),format:e=>g(e,c)}],t=((b=i==null?void 0:i.react_table_columns)==null?void 0:b.project)||se;return a.filter(e=>t.includes(e.column)).sort((e,n)=>t.indexOf(e.column)-t.indexOf(n.column))}function le(){const[o]=y(),c=q(),r=S(),l=Q(),d=F(),{isEditOrShowPage:_}=W({entity:"project",editPageTabs:["documents"]}),i=Z(oe),p=t=>{i({...t,id:"",documents:[],number:""}),c("/projects/create?action=clone")},{setChangeTemplateResources:h,setChangeTemplateVisible:j,setChangeTemplateEntityContext:x}=N();return[t=>r("create_invoice")&&s.jsx(u,{onClick:()=>d([t.id]),icon:s.jsx(m,{element:B}),children:o("invoice_project")}),t=>r("create_project")&&s.jsx(u,{onClick:()=>p(t),icon:s.jsx(m,{element:$}),children:o("clone")}),t=>s.jsx(u,{onClick:()=>{j(!0),h([t]),x({endpoint:"/api/v1/projects/bulk",entity:"project"})},icon:s.jsx(m,{element:I}),children:o("run_template")}),()=>_&&s.jsx(G,{withoutPadding:!0}),t=>f(t)===C.Active&&_&&s.jsx(u,{onClick:()=>l([t.id],"archive"),icon:s.jsx(m,{element:J}),children:o("archive")}),t=>(f(t)===C.Archived||f(t)===C.Deleted)&&_&&s.jsx(u,{onClick:()=>l([t.id],"restore"),icon:s.jsx(m,{element:K}),children:o("restore")}),t=>(f(t)===C.Active||f(t)===C.Archived)&&_&&s.jsx(u,{onClick:()=>l([t.id],"delete"),icon:s.jsx(m,{element:U}),children:o("delete")})]}const re=()=>{const[o]=y(),c=S(),r=te(),l=F(),d=a=>a.some(({documents:t})=>t.length),_=a=>a.flatMap(({documents:t})=>t.map(({id:b})=>b)),i=(a,t)=>{const b=_(a);r(b,"download"),t([])},{setChangeTemplateVisible:p,setChangeTemplateResources:h,setChangeTemplateEntityContext:j}=N();return[({selectedIds:a,setSelected:t})=>c("create_invoice")&&s.jsx(u,{onClick:()=>{l(a),t([])},icon:s.jsx(m,{element:B}),children:o("invoice_project")}),({selectedResources:a,setSelected:t})=>s.jsx(u,{onClick:()=>d(a)?i(a,t):X.error("no_documents_to_download"),icon:s.jsx(m,{element:ee}),children:o("documents")}),({selectedResources:a})=>s.jsx(u,{onClick:()=>{p(!0),h(a),j({endpoint:"/api/v1/projects/bulk",entity:"project"})},icon:s.jsx(m,{element:I}),children:o("run_template")})]};export{le as a,re as b,ne as c,se as d,ce as u};
